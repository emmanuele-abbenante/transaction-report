--Expenses grouped by kind
SELECT 
CASE
	WHEN COUNTERPART = 'PENNY MARKET' THEN 'Spesa'
	WHEN COUNTERPART = 'UPIM SAN GOTTARDO' THEN 'Abbigliamento'
	WHEN COUNTERPART = 'FARMACIA STAZIONE PORTA G' THEN 'Farmaci'
	WHEN COUNTERPART = 'FARMACIA MONCUCCO SNC' THEN 'Farmaci'
	WHEN COUNTERPART = 'BEATO TE' THEN 'Pranzi lavoro'
	WHEN COUNTERPART = 'SCARPAMONDO' THEN 'Abbigliamento'
	WHEN COUNTERPART = 'ATLANTIC LORENTEGGIO' THEN 'Pranzi lavoro'
	WHEN COUNTERPART = 'ESSELUNGA LORENTEGGIO' THEN 'Spesa'
	WHEN COUNTERPART = 'CASH ISP 1221-MILAN' THEN 'Prelievo'
	WHEN COUNTERPART = 'Gabriella Gruppi' THEN 'Affitto'
    ELSE REASON
END AS Spesa,
SUM(CURRENCY_AMOUNT) AS Importo
from TRANSACTIONS
WHERE CURRENCY_AMOUNT < 0
GROUP BY Spesa

UNION

SELECT 
'Totale' AS Spesa,
SUM(CURRENCY_AMOUNT) AS Importo
from TRANSACTIONS
WHERE CURRENCY_AMOUNT < 0;